# 계층형 아키텍쳐의 문제
계층형 아키텍쳐는 코드에 나쁜 습관들이 스며들기 쉽게 만들고 시간이 지날수록 소프트웨어를 점점더 변경하기 어렵게 만드는 문제가 있음

### 계층형 아키텍쳐는 데이터베이스 주도 설계를 유도한다.

```
  웹
  |
도메인
  |
영속성
```

- 웹 계층은 도메인 계층에 의존하고 도메인 계층은 영속성 계층에 의존하기 때문에 결국에 데이터베이스에 의존하게 된다.
- 데이터베이스 중심의 아키텍쳐가 만들어지는 가장 큰 원인은 ORM을 사용하기 때문이다.
- ORM에서 관리되는 엔티티들은 영속석 계층에 속하고 아래 방향으로만 접근이 가능하기 때문에 강한 결합이 생김
- 서비스(도메인 계층)는 영속성 모델(엔티티)를 비즈니스 모델처럼 사용하게 되고 이로 인해 영속성 계층과 관련된 작업(트랜잭션, 캐시, 지연/즉시 로딩)을 해야한다.
- 둘중 하나만 바꾸기가 어렵다.

### 지금길을 택하기 쉬워진다. 
하위 계층에서 상위 계층에 접근해야 한다면? 그냥 상위 계층을 하위 계층으로 내려버리게 되고 결국 영속성 계층이 비대해짐

### 테스트하기 어려워 진다.
엔티티의 필드를 단 하나만 조작하면 되는 경우 웹계층에서 바로 영속성 계층으로 접근하게 된다. 이로 인해 두가지의 문제가 발생한다.

1. 도메인 로직을 웹계층에 구현하게 되고. 결국 도메인 로직이 여기저기 퍼지게 됨
2. 테스트를 위해 영속성 계층 또한 모킹해야함

### 유스케이스를 숨긴다.

계층형 아키택쳐는 도메인 서비스의 너비에 관한 규칙을 강제하지 않기 때문에 여러개의 유스케이스를 담당하는 넓은 서비스가 생겨난다. 

### 동시 작업이 어려워 진다.

계층형 아키텍쳐에서는 모든 것이 영속성 계층위에 만들어지기 때문에 영속성 계층, 도메인 계층, 웹계층을 순서대로 개발해야한다. 따라서 하나의 기능에 한명의 개발자만 작업할수 있다.

