# 변경 가능성을 최소화 하라

## 불변 클래스!!!
> **인스턴스 내부의 값을 수정할 수 없는 클래스**  
> 
불변 클래스 내부에 정의된 값들은 객체가 파괴되는 순간까지 절대 변경되지 않는다. 따라서 오류가 생길 여지가 적고 훨씬 안전하다.

-  불변 클래스로 만드는 법칙
   1. 객체의 상태를 변경하는 메서드(setter)를 제공하지 않는다.
   2. 클래스를 확장할 수 없도록 한다.(final class)
   3. 모든 필드를 final로 선언한다.
   4. 모든 필드를 private로 선언한다.
   5. 자신 외에는 내부의 가변 컴포넌트에 접근할 수 없도록 한다.
      - 만약 내부의 가변 컴포넌트를 제공해야 한다면 방어적 복사를 해야한다.
<br>
- 불변 객체는 스레드 세이프하며 따로 동기화할 필요가 없다.
   - 여러 스레드에서 동시에 사용해도 훼손되지 않는다.
<br>
-  객체를 만들때 다른 불변 객체들을 구성요소로 사용하면 이점이 많다.
   - 불변 객체는 map의 key와 set의 원소로 쓰기에 안성 맞춤이다.
<br>
-  불변 객체는 그 자체로 실패 원자성을 제공한다.
    - 상태가 변하지 않으니 불일치 상태에 빠지지 않는다.
<br>
- 값이 다르다면 반드시 독립된 객체로 만들어야 한다.(이것은 단점이다)
<br>
- **클래스는 꼭 필요한 경우가 아니라면 불변이여야 한다.**
  - 불변 클래스는 장점이 많으며 단점이라곤 특정 상황에서의 성능저하뿐이다.
  - 불변으로 만들수 없는 클래스더라도 변경할 수 있는 부분을 최소화 하자.
   
### 불변 클래스 예시

```java
public class Complex{
    private final double re;
    private final double im;

    private Complex(double re, double im){
        this.re = re;
        this.im = im;
    }

    public static Complex valueOf(double re, double im){
        return new Complex(re, im);
    }
}
```